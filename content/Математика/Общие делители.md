# Общие делители

Наибольший общий делитель и наименьшее общее кратное.

- {{ математика }}
- {{ наибольший общий делитель }}
- {{ наименьшее общее кратное }}
- {{ алгоритмы }}
- {{ вычисления }}

Вычисление можно проводить на примере задачи:

```
Мимо станции железной дороги проходят один за другим три поезда: 
в первом 418 пассажиров, во втором 494 и в третьем 456. 
Сколько пассажирских вагонов в каждом поезде, если известно, 
что в каждом вагоне находится по одинаковому числу пассажиров 
и их число наибольшее из всех возможных?
```

Для определения делителя числа удобно записывать числа в столбик.

| Число | Делители | Число  | Делители | Число | Делители |
| ----- | -------- | ------ | -------- | ----- | -------- |
| 418   | **2**    | 494    | **2**    | 456   | **2**    |
| 209   | 11       | 247    | 13       | 228   | 2        |
| 19    | **19**   | **19** | **19**   | 114   | 2        |
|       |          |        |          | 57    | 3        |
|       |          |        |          | 19    | **19**   |

Размер вагона равен наибольшему общему делителю и составляет 2 * 19 = 38
пассажиров, соответственно вагонов 11, 13 и 12.

Альтернативная (т.н. каноничная) форма записи:

418 = 2 * 11 * 19

494 = 2 * 13 * 19

456 = 2<sup>3</sup> * 3 * 19

*Наибольший общий делитель (greatest common divisor/factor)* - произведение
простых множителей, общих для всех искомых чисел, взятых с **НАИМЕНЬШИМ**
общим для всех показателем степени.

*Наименьшее общее кратное (lowest/least common multiple)* - произведение
простых множителей, общих для всех искомых чисел, взятых с **НАИБОЛЬШИМ**
показателем степени из имеющихся.

Для чисел [60, 252, 264] GCD каноничные формы:

60 = 2<sup>2</sup> * 3 * 5

252 = 2<sup>2</sup> * 3<sup>2</sup> * 7

264 = 2<sup>3</sup> * 3 * 11

GCD/НОД равен 2<sup>2</sup> * 3 = 12.

LCM/НОК равно 2<sup>3</sup> * 3<sup>2</sup> * 5 * 7 * 11 = 27 720

Соотношение GCD и LCM:

    GCD(a, b) = (a * b) / LCM(a, b)

## Признаки делимости числа

| Делится на |                      Признак делимости                       | Пример        |
| ---------- | :----------------------------------------------------------: | ------------- |
| 2          |                 Последняя цифра чётная или 0                 | 27 374 -> 4   |
| 3          |                   Сумма цифр делится на 3                    | 27 375 -> 24  |
| 4          |          Число из двух последних цифр делится на 4           | 27 032 -> 32  |
| 5          |                   Последняя цифра 0 или 5                    | 23 330 -> 0   |
| 9          |                   Сумма цифр делится на 9                    | 488 718 -> 36 |
| 10         |                      Последняя цифра 0                       | 270 -> 0      |
| 11         | Сумма цифр вида a<sub>0</sub> - a<sub>1</sub> + a<sub>2</sub> ... делится на 11 | 38 137 -> 0   |
| 25         |          Число из двух последних цифр делится на 25          | 3 300 -> 0    |

## Алгоритм Евклида

Упрощённое определение:

    Если большее из двух данных чисел делится на меньшее, то число, 
    которое меньше и будет их наибольшим общим делителем.

Пример вычисления для 140 и 96:

![divisor](Общие%20делители.png)

GCD равен 4.

## Остаток от деления (modulo)

    а = b • n + r

Где:

- a это исходное число.
- b это число, на которое мы делим.
- n это неполное частное (результат целочисленного деления a на b).
- r это собственно остаток.

Типичный пример применения это разложение числовых кодов на блоки типа <серия>
-<номер>. Например маркировка записывается как "01-00033", а численно хранится
как val=100033.

Получение компонент выполняется как:

```python
series = 100033 // 100_000
number = 100033 % 100_000
```

Или как:

```python
series, number = divmod(100033, 100_000)
```

#### Вычисление простого числа наивным способом, сложность O(n)

Проверяемое число n делить на все числа подряд range(2, n). Если все они
делятся с остатком, то число простое. Можно учесть, что все простые числа
больше двух - нечётные. Тогда можно идти с шагом 2 и уменьшить сложность вдвое.

#### Вычисление простого числа чуть менее наивным способом, сложность O(sqrt(n))

Проверяемое число n делить на все числа подряд range(2, sqrt(n)). Если все они
делятся с остатком, то число простое.

Логика за этим решением для числа 81:

| Делитель | Остаток |
| -------- | ------- |
| 1        | 0       |
| 2        | 1       |
| 3        | 0       |
| 4        | 1       |
| 5        | 1       |
| 6        | 3       |
| 7        | 4       |
| 8        | 1       |
| 9        | 0 <<    |
| 10       | 1       |
| 11       | 4       |
| 12       | 9       |
| 13       | 3       |
| 14       | 11      |
| 15       | 6       |
| 16       | 1       |
| 17       | 13      |
| 18       | 9       |
| 19       | 5       |
| 20       | 1       |
| 21       | 18      |
| 22       | 15      |
| 23       | 12      |
| 24       | 9       |
| 25       | 6       |
| 26       | 3       |
| 27       | 0       |

Предположим, что у **n** есть некий делитель **p1**. Тогда **p2=n/p** это тоже
делитель этого числа. Если они разные, то нас интересует меньший из них, а если
одинаковые, то они максимум могут быть равны **sqrt(n)**. Поэтому перебрав все
целые числа от 2 до **sqrt(n)**, мы точно найдём хоть один делитель, если такой
есть.

#### Решето Эратосфена, сложность O(n * log(log(n)))

1. Выписать подряд все целые числа от двух до n (2, 3, 4, …, n).
1. Пусть переменная p изначально равна двум — первому простому числу.
1. Зачеркнуть в списке числа от 2p до n считая шагами по p (это будут числа
   кратные p: 2p, 3p, 4p, …).
1. Найти первое не зачёркнутое число в списке, большее чем p, и присвоить
   значению переменной p это число.
1. Повторять шаги 3 и 4, пока возможно.

Теперь все не зачёркнутые числа в списке — это все простые числа от 2 до n.

Пример для n = 30:

    2  3  4  5  6  7  8  9  10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30

Первое число в списке, 2 — простое. Пройдём по ряду чисел, зачёркивая все
числа, кратные 2 (то есть, каждое второе, начиная с 2<sup>2</sup> = 4):

    2  3     5     7     9     11    13    15    17    19    21    23    25    27    29

Следующее не зачёркнутое число, 3 — простое. Пройдём по ряду чисел, зачёркивая
все числа, кратные 3 (то есть, каждое третье, начиная с 3<sup>2</sup> = 9):

    2  3     5     7           11    13          17    19          23    25          29

Следующее не зачёркнутое число, 5 — простое. Пройдём по ряду чисел, зачёркивая
все числа, кратные 5 (то есть, каждое пятое, начиная с 5<sup>2</sup> = 25):

    2  3     5     7           11    13          17    19          23                29

Следующее не зачёркнутое число — 7. Его квадрат, 49 — больше 30, поэтому на
этом работа завершена. Все составные числа уже зачеркнуты:

    2  3     5     7           11    13          17    19          23                29

Оптимизации:

* На шаге № 3 числа можно зачеркивать начиная сразу с числа p2, потому что все
  составные числа меньше него уже будут зачеркнуты к этому времени. И,
  соответственно, останавливать алгоритм можно, когда p2 станет больше, чем n.
* Все простые числа (кроме 2) — нечётные числа, и поэтому для них можно считать
  шагами по 2p, начиная с p2.

<hr>

Стоит помнить:

- Ноль считается делимым на любое число.
- Если число делится на себя и на 1 (т. е. два делителя) то оно простое.
- Если делителей больше двух, то оно составное.
- Число 1 не относится ни к тем ни к другим.
- Если из общих делителей только 1, то числа называются взаимно простыми.
- Хороший пример применения LCM - шестерни в коробке передач. Для возможности
  возврата их в исходную ориентацию после нескольких оборотов, они должны иметь
  кратное LCM число зубов.
- Хороший пример применения GCD - квадратная плитка на полу / квадратные
  сектора в матрице. Закрыть площадь прямоугольника квадратными секторами можно
  только плиткой с шириной кратной GCD.
