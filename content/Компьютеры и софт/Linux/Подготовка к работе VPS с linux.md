# Подготовка к работе VPS с linux



---

Теги:

- {{ компьютеры }}
- {{ программное обеспечение }}
- {{ linux }}
- {{ полезные рецепты }}
- {{ системное администрирование }}
- {{ Установка ОС }}

---

## 1. Установка пароля для root

```shell
sudo passwd root
```

## 2. Настройка доступа по SSH

Важно: перед тем как пытаться настроить SSH, надо убедиться в том, что мы сами
себе не оборвём доступ. Во-первых, если идёт подключение по публичному ключу,
он должен быть добавлен на машину до начала настройки. Во-вторых, надо
убедиться, что нам не помешают настройки файерволла. Например, порт 22 может
быть по умолчанию открыт. Но если мы захотим вывести SSHD на другой порт, надо
проверить настройки файерволла и, при необходимости, заранее открыть нужный
порт.

Скопировать публичный ключ на машину, к которой уже есть ssh доступ:

```shell
ssh-copy-id -i ~/.ssh/id_rsa.pub user@serverip
```

Изменение конфига:

```shell
sudo nano /etc/ssh/sshd_config
```

Стоит установить:

```
Port <любой отличающийся от 22 чтобы избежать сканеров>
AllowUsers <список пользователей, которым можно заходить на хост>
PermitRootLogin no
PasswordAuthentication no
PermitEmptyPasswords no
PubkeyAuthentication yes
```

```shell
sudo systemctl restart sshd
```

После этого имеет смысл прописать в своём ssh конфиге:

```
Host <удобное имя для хоста, например cool>
    User <имя пользователя, например admin>
    Port <номер порта, например 22>
    HostName <hostname, если есть или ip адрес, например some-host.com>
```

Если для доступа используется отдельный файл с ключом, ниже надо добавить:

```
	IdentityFile <имя файла, например file.pem>
```

После этого можно будет ходить на машину просто через:

```shell
ssh cool
```
